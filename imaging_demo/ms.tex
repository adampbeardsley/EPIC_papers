% mnras_template.tex
%
% LaTeX template for creating an MNRAS paper
%
% v3.0 released 14 May 2015
% (version numbers match those of mnras.cls)
%
% Copyright (C) Royal Astronomical Society 2015
% Authors:
% Keith T. Smith (Royal Astronomical Society)

% Change log
%
% v3.0 May 2015
%    Renamed to match the new package name
%    Version number matches mnras.cls
%    A few minor tweaks to wording
% v1.0 September 2013
%    Beta testing only - never publicly released
%    First version: a simple (ish) template for creating an MNRAS paper

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Basic setup. Most papers should leave these options alone.
\documentclass[a4paper,fleqn,usenatbib]{../mnras}

% MNRAS is set in Times font. If you don't have this installed (most LaTeX
% installations will be fine) or prefer the old Computer Modern fonts, comment
% out the following line
\usepackage{newtxtext,newtxmath}
% Depending on your LaTeX fonts installation, you might get better results with one of these:
%\usepackage{mathptmx}
%\usepackage{txfonts}

% Use vector fonts, so it zooms properly in on-screen viewing software
% Don't change these lines unless you know what you are doing
\usepackage[T1]{fontenc}
\usepackage{ae,aecompl}


%%%%% AUTHORS - PLACE YOUR OWN PACKAGES HERE %%%%%

% Only include extra packages if you really need them. Common packages are:
\usepackage{graphicx}	% Including figure files
\usepackage{amsmath}	% Advanced maths commands
\usepackage{amssymb}	% Extra maths symbols

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%% AUTHORS - PLACE YOUR OWN COMMANDS HERE %%%%%

% Please keep new commands to a minimum, and use \newcommand not \def to avoid
% overwriting existing commands. Example:
%\newcommand{\pcm}{\,cm$^{-2}$}	% per cm-squared
\newcommand{\Nant}{N_{\text{ant}}} 
\newcommand{\Npix}{N_{\text{pix}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%% TITLE PAGE %%%%%%%%%%%%%%%%%%%

% Title of the paper, and the short title which is used in the headers.
% Keep the title short and informative.
\title[E-field Parallel Imaging Correlator]{A Generic and Efficient E-field Parallel Imaging Correlator for Next-Generation Radio Telescopes}

% The list of authors, and the short list which is used in the headers.
% If you need two or more lines of authors, add an extra line using \newauthor
\author[Thyagarajan et al.]{
Nithyanandan Thyagarajan,$^{1}$\thanks{E-mail: t\_nithyanandan@asu.edu}
Adam P. Beardsley,$^{1}$
Judd D. Bowman$^{1}$
\newauthor
and Miguel F. Morales$^{2}$
\\
% List of institutions
$^{1}$Arizona State University, School of Earth and Space Exploration, Tempe, AZ 85287, USA\\
$^{2}$University of Washington, Department of Physics, Seattle, WA 98195, USA\\
}

% These dates will be filled out by the publisher
\date{Accepted XXX. Received YYY; in original form ZZZ}

% Enter the current year, for the copyright statements etc.
\pubyear{2015}

% Don't change these lines
\begin{document}
\label{firstpage}
\pagerange{\pageref{firstpage}--\pageref{lastpage}}
\maketitle

% Abstract of the paper
\begin{abstract}
Abstract here (250 words)
\end{abstract}

% Select between one and six entries from the list of approved keywords.
% Don't make up new ones.
\begin{keywords}
instrumentation: interferometers -- techniques: image processing -- techniques: interferometric
\end{keywords}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%% BODY OF PAPER %%%%%%%%%%%%%%%%%%

\section{Introduction}

Radio astronomy is entering an era in which interferometers of hundreds to thousands of individual antennas are needed to achieve desired survey speeds. Nowhere is this more apparent than at radio frequencies below 1.4 GHz. The study of the history of hydrogen gas throughout the universe's evolution is pushing technology development towards arrays of low-cost antennas with large fields of view and densely packed apertures. Similarly, the search for transient objects and regular monitoring of the time-dependent sky is driving instruments in the same direction. A number of new telescopes are under development around the world based on this new paradigm, including the Murchison Widefield Array (MWA, \citealt{tin13}), the Precision Array for Probing the Epoch of Reionization (PAPER, \citealt{par10}), the Hydrogen Epoch of Reionization Array (HERA, \citealt{pob14}), the LOw Frequency ARray (LOFAR, \citealt{dev09}), the Canadian Hydrogen Intensity Mapping Experiment (CHIME, \citealt{ban14}), the Long Wavelength Array (LWA, \citealt{ell13}), and the low frequency component of the Square Kilometer Array Low Frequency Aperture Array (SKA-Low \citealt{mel13}).

This paradigm shift requires a fundamentally new approach to the design of digital correlators \citep{lon00}. Modern correlators calculate the cross-power correlation between all antenna pairs in many narrow frequencies, forming \emph{visibilities}, the traditional fundamental measurement of radio interferometers. The computational requirements for a modern FX correlator scale with the number of antenna pairs, or the square of the number of antennas $\sim \Nant^2$ \citep{bun04}. For this reason traditional correlators have difficulty scaling to thousands of antennas. As an example, the full HERA correlator for 352 dishes with 200 MHz of bandwidth requires 212 trillion complex multiplies and adds per second (TMACS). Future arrays with thousands of collecting elements will require orders of magnitude more computation, making the correlator the dominant cost.

For certain classes of radio arrays there is an alternative to the FX correlator that can lower the computational burden by directly performing a spatial fast Fourier transform (FFT) on the electric fields measured by each antenna in the array at each time step, removing the cross-correlation step. This relieves the computational scaling from the harsh $\Nant^2$ to the more gentle envelope of $\Npix\log\Npix$, where $\Npix$ is the number of pixels in the Fourier transform \citep[e.g.][]{mor11,teg09,teg10}. This architecture is often referred to as a ``direct imaging" correlator because it eliminates the intermediary cross-correlation data products of the FX and earlier lag correlators, but instead directly forms images from the electric field measurements.

Direct imaging correlators have begun to be explored on deployed arrays including the Basic Element for SKA Training II (BLAST-2) array \citep{fos14}, the Omniscope \citep{zhe14}, and an earlier incarnation at higher frequencies with the intent of pulsar timing \citep{oto94, dai00}. However, each of these examples make assumptions about the redundancy of the array layout, and require the collecting elements are identical. On the other hand, the MOFF algorithm achieves the same $\Npix \log \Npix$ computational scaling without placing any restriction on antenna placement, can accommodate non-identical beam patterns, and is a provably optimal mapping \citep{mor11}. This algorithm uses the antenna beam patterns to grid the electric field measurements to a regular grid in the software holography/A-transpose fashion \citep{mor09, bha08, teg97} before performing the spatial FFT. This process has been shown to theoretically produce a data product identical to images produced from the traditional FX correlator.

Here we present the first software implementation of the MOFF correlator, and announce the public release of the E-field Parallel Imaging Correlator (EPIC) code. We begin with a technical description of the algorithm in \S \ref{sec:math}, then discuss our particular implementation in \S \ref{sec:software}. We then verify the output data quality from our code in \S \ref{sec:verify} by presenting simulated images from both the EPIC correlator and comparing to a simulated FX correlator. We also demonstrate the performance with real-world data from the LWA. In \S \ref{sec:analysis} we analyze the scaling relationships of the algorithm. We identify specific array design classes where the EPIC correlator is computationally more efficient than the FX algorithm. We conclude and discuss future research prospects in \S\ref{sec:conclusions}

Motivate MOFF from a technical and scientific standpoint. Refer to \citet{del07,mor09,mor11}.

\section{Mathematical Framework}\label{sec:math}

Refresh the math equivalence between MOFF and FX.

\section{Software Implementation}\label{sec:software}

Discuss implementation and make code available for public.

Calibration

\section{Verification}\label{sec:verify}

Show examples using simulations

Discuss PSF differences due to slight differences arising out of gridding

Apply it on LWA data

\section{Analysis and Feasibility}\label{sec:analysis}
\subsection{Scaling Relations: MOFF vs. FX}
\subsection{Scaling Up}
\subsection{Case Study}
% \subsection{Figures and tables}

% Figures and tables should be placed at logical positions in the text. Don't
% worry about the exact layout, which will be handled by the publishers.

% Figures are referred to as e.g. Fig.~\ref{fig:example_figure}, and tables as
% e.g. Table~\ref{tab:example_table}.

% % Example figure
% \begin{figure}
% 	% To include a figure from a file named example.*
% 	% Allowable file formats are eps or ps if compiling using latex
% 	% or pdf, png, jpg if compiling using pdflatex
% 	\includegraphics[width=\columnwidth]{example}
%     \caption{This is an example figure. Captions appear below each figure.
% 	Give enough detail for the reader to understand what they're looking at,
% 	but leave detailed discussion to the main body of the text.}
%     \label{fig:example_figure}
% \end{figure}

% % Example table
% \begin{table}
% 	\centering
% 	\caption{This is an example table. Captions appear above each table.
% 	Remember to define the quantities, symbols and units used.}
% 	\label{tab:example_table}
% 	\begin{tabular}{lccr} % four columns, alignment for each
% 		\hline
% 		A & B & C & D\\
% 		\hline
% 		1 & 2 & 3 & 4\\
% 		2 & 4 & 6 & 8\\
% 		3 & 5 & 7 & 9\\
% 		\hline
% 	\end{tabular}
% \end{table}

\section{Conclusions}\label{sec:conclusions}
\section*{Acknowledgements}

The Acknowledgements section is not numbered. Here you can thank helpful
colleagues, acknowledge funding agencies, telescopes and facilities used etc.
Try to keep it short.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%% REFERENCES %%%%%%%%%%%%%%%%%%

% The best way to enter references is to use BibTeX:

\bibliographystyle{../mnras}
\bibliography{../epic} % if your bibtex file is called example.bib


% Alternatively you could enter them by hand, like this:
% This method is tedious and prone to error if you have lots of references
% \begin{thebibliography}{99}
% \bibitem[\protect\citeauthoryear{Author}{2012}]{Author2012}
% Author A.~N., 2013, Journal of Improbable Astronomy, 1, 1
% \bibitem[\protect\citeauthoryear{Others}{2013}]{Others2013}
% Others S., 2012, Journal of Interesting Stuff, 17, 198
% \end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%% APPENDICES %%%%%%%%%%%%%%%%%%%%%

\appendix

\section{Some extra material}

If you want to present additional material which would interrupt the flow of the main paper,
it can be placed in an Appendix which appears after the list of references.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Don't change these lines
\bsp	% typesetting comment
\label{lastpage}
\end{document}

% End of mnras_template.tex